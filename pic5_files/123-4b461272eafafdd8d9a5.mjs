(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[123],{"0BOE":function(e,t,i){i.d(t,"a",(function(){return r}));const n={á:"a",à:"a",â:"a",ä:"a",ã:"a",å:"a",æ:"a",ç:"c",é:"e",è:"e",ê:"e",ë:"e",í:"i",ì:"i",î:"i",ï:"i",ñ:"n",ó:"o",ò:"o",ô:"o",ö:"o",õ:"o",ø:"o",œ:"o",ß:"s",ú:"u",ù:"u",û:"u",ü:"u"},o=e=>{if(!e)return"";let t="";for(let i=0;i<e.length;i+=1)t+=n[e.charAt(i)]||e.charAt(i);return t},r=(e,t,i="name")=>{const n=t.toLowerCase();return e.filter(e=>((e,t)=>{const i=t.split(" "),n=e.split(" ");let r=0;for(let s=0;s<n.length;s+=1)(o(n[s]).includes(i[r])||n[s].includes(i[r]))&&(r+=1);return r===i.length})(e[i].toLowerCase(),n))}},"1RGD":function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("q1tI"),o=i("yweb"),r=i("vvax"),s=i("n6mq"),a=i("nKUr");function d({header:e,onUpdate:t,value:i}){const d=Object(o.c)(),[l,c]=Object(n.useState)(i?String(Math.floor(Number.parseInt(i,10)/60)):"0"),[u,h]=Object(n.useState)(i?String(Number.parseInt(i,10)%60):"0"),b=(e,i)=>{t(String(Number.parseInt(i,10)+60*Number.parseInt(e,10)))},p=[];for(let n=0;n<=9;n+=1)p.push({value:String(n),label:Object(r.b)(d.ngettext("{{ hours }} hour","{{ hours }} hours",n,"storyboard.detailsList.recipe","Option for number of hours a story pin recipe will take"),{hours:n}).join("")});const f=[];for(let n=0;n<60;n+=1)f.push({value:String(n),label:Object(r.b)(d.ngettext("{{ minutes }} minute","{{ minutes }} minutes",n,"storyboard.detailsList.recipe","Option for number of minutes a story pin recipe will take"),{minutes:n}).join("")});return Object(a.jsxs)(s.f,{width:"100%",display:"flex",alignItems:"end",children:[Object(a.jsx)(s.f,{width:"50%",marginEnd:2,children:Object(a.jsx)(s.S,{size:"lg",id:"hours",name:"hours",label:e,placeholder:d._("Hours","storyboard.detailsList.recipe","Placeholder caption for hours input in story pin recipe cooktime"),value:l,options:p,onChange:({value:e})=>{Number.isNaN(e)||(c(e),b(e,u))}})}),Object(a.jsx)(s.f,{width:"50%",marginStart:2,children:Object(a.jsx)(s.S,{size:"lg",id:"minutes",name:"minutes",placeholder:d._("Minutes","storyboard.detailsList.recipe","Placeholder caption for minutes input in story pin recipe cooktime"),value:u,options:f,onChange:({value:e})=>{Number.isNaN(e)||(h(e),b(l,e))}})})]})}},"2K7C":function(e,t,i){i.d(t,"a",(function(){return s}));var n=i("yweb"),o=i("n6mq"),r=i("nKUr");function s(){const e=Object(n.c)();return Object(r.jsx)(o.f,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(o.U,{accessibilityLabel:e._("Loading editor","EditorWithMentionsFallback.loading","Message shown while waiting for the editor to load"),show:!0})})}},"2WXK":function(e,t,i){var n=i("q1tI");let o=null,r=!1,s=0;const a=()=>{o&&clearTimeout(o),r=!0,o=setTimeout(()=>{r=!1},100)};t.a=()=>{const[e,t]=Object(n.useState)(!1),i=Object(n.useRef)(null);Object(n.useEffect)(()=>(0===s&&window.addEventListener("scroll",a),s+=1,()=>{i.current&&clearTimeout(i.current),s-=1,s||window.removeEventListener("scroll",a)}),[]);const o=e=>{i.current&&clearTimeout(i.current),i.current=e&&r?setTimeout(()=>o(!0),100):setTimeout(()=>{t(e)},32)};return{isHovering:e,hoverHandlers:Object(n.useRef)({onMouseOver:()=>o(!0),onMouseLeave:()=>o(!1)}).current}}},"3z7j":function(e,t,i){i.d(t,"a",(function(){return o}));var n=i("Wer7");function o(e,t){return i=>i(Object(n.a)("BoardSectionResource",{field_set_key:t||"board_page",section_id:e}))}},"5FNA":function(e,t,i){i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return l}));var n=i("qtKf"),o=i("Pqnw"),r=i("Wer7");const s=["alphabetical","last_pinned_to","oldest","newest","group_boards_at_top","custom"],a={name:"BoardsResource",key:"boardsResource",options:({boardOrder:e,filterStories:t,mixPublicSecret:i,username:n})=>({privacy_filter:"all",sort:e||"last_pinned_to",field_set_key:"profile_grid_item",filter_stories:t,username:n,page_size:25,group_by:i?"mix_public_private":"visibility",include_archived:!0,redux_normalize_feed:!0})},d=(e,t,i)=>({privacy_filter:t?"secret":"public",sort:i||"last_pinned_to",field_set_key:"profile_grid_item",username:e}),l=e=>s.reduce((t,i)=>{const s=[Object(o.a)("profileBoards",Object(n.c)(e,i))];return[!0,!1].forEach(t=>{[!0,!1].forEach(n=>{s.push(Object(r.f)(a.name,a.options({username:e,boardOrder:i,mixPublicSecret:t,filterStories:n})))})}),t.concat(s)},[])},"5S2N":function(e,t,i){i.d(t,"c",(function(){return we})),i.d(t,"b",(function(){return Ee}));var n=i("q1tI"),o=i("/MKj"),r=i("9WJf"),s=i("BkRI"),a=i.n(s),d=i("yweb"),l=i("n6mq"),c=i("nKUr");function u({commentsDisabled:e,onCommentChange:t,onPhotoChange:i,photosDisabled:n,isManagedView:o,isNoTitle:r}){const s=Object(d.c)(),a=o?6:r?0:3;return Object(c.jsxs)(l.f,{children:[!r&&Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:o?0:4,paddingY:a,children:[!o&&!r&&Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",children:s._("Comment and Photo Permissions")})}),Object(c.jsxs)(l.f,{column:12,mdColumn:o?12:8,children:[Object(c.jsxs)(l.f,{paddingY:1,display:"flex",alignItems:"center",children:[Object(c.jsx)(l.W,{onChange:t,id:"CommentSwitch",switched:!e}),Object(c.jsx)(l.f,{paddingX:2,children:Object(c.jsx)(l.z,{htmlFor:"CommentSwitch",children:Object(c.jsx)(l.bb,{size:"md",children:s._("Allow people to comment","Label for toggling comments on a pin in pin edit form","Label for toggling comments on a pin in pin edit form")})})})]}),i&&Object(c.jsxs)(l.f,{paddingY:1,alignItems:"center",display:"flex",children:[Object(c.jsx)(l.W,{onChange:i,id:"PhotoSwitch",switched:!n}),Object(c.jsx)(l.f,{paddingX:2,children:Object(c.jsx)(l.z,{htmlFor:"PhotoSwitch",children:Object(c.jsx)(l.bb,{size:"md",children:s._("Allow people to upload photos","Label for toggling photos on a pin in pin edit form","Label for toggling photos on a pin in pin edit form")})})})]})]})]})]})}var h=i("JW66"),b=i("eOdZ"),p=i("5FNA"),f=i("Wer7");var j=i("Sihc"),g=i("Y+p1"),m=i.n(g),y=i("TgLd"),x=i("GBVV"),_=i("4cpq"),O=i("M1Uz"),v=i("nGHF");function S(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class C extends n.PureComponent{constructor(...e){super(...e),S(this,"state",{deleting:!1}),S(this,"unmounted",!1),S(this,"handleConfirm",()=>{if(this.state.deleting)return;const{onDeletePin:e}=this.props;this.setState({deleting:!0}),e().then(()=>this.handleDeleteDidComplete()).catch(e=>this.handleDeleteDidComplete(e))}),S(this,"handleDeleteDidComplete",e=>{const{toastManagerContext:t}=this.props;this.unmounted||this.setState({deleting:!1}),e||t.showToast(({onHide:e})=>Object(c.jsx)(O.a,{onHide:e,text:this.props.i18n._("Pin deleted!","User deleted their pin","User deleted their pin")}))})}componentWillUnmount(){this.unmounted=!0}render(){const{onDismiss:e}=this.props,{deleting:t}=this.state;return Object(c.jsx)(y.b,{heading:this.props.i18n._("Are you sure?","Confirm the user wants to delete the pin","Confirm the user wants to delete the pin"),accessibilityModalLabel:this.props.i18n._("Are you sure you want to delete this pin?","Accessible label to confirm the user wants to delete the pin","Accessible label to confirm the user wants to delete the pin"),size:"sm",onDismiss:e,footer:Object(c.jsxs)(l.f,{display:"flex",justifyContent:"end",marginStart:-1,marginEnd:-1,children:[Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{fullWidth:!0,onClick:e,text:this.props.i18n._("Cancel")})}),Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(_.a,{id:"confirm-delete-pin",children:Object(c.jsx)(x.b,{color:"red",onClick:this.handleConfirm,text:this.props.i18n._("Delete Pin"),submitting:t})})})]}),children:Object(c.jsx)(l.f,{padding:4,children:Object(c.jsx)(l.bb,{children:this.props.i18n._("Once you delete a Pin, you can't undo it!")})})})}}const w=Object(v.c)((function(e){const t=Object(d.c)();return Object(c.jsx)(C,{...e,i18n:t})}));w.displayName="DeletePinConfirmation";var I=w;function E({canEdit:e,onAltTextChange:t,altText:i}){const o=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"AltTextField",children:Object(c.jsx)(l.bb,{size:"md",children:o._("Alt text","EditPinModal.EditAltText","Label for editing alt text of pin")})})}),Object(c.jsx)(l.f,{column:12,mdColumn:8,children:e?Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.f,{children:Object(c.jsx)(l.db,{id:"AltTextField",onChange:({value:e})=>t({value:e.slice(0,500)}),size:"lg",value:i||""})}),Object(c.jsx)(l.f,{children:Object(c.jsx)(l.z,{htmlFor:"AltTextField",children:Object(c.jsx)(l.f,{marginTop:1,children:Object(c.jsx)(l.bb,{size:"md",color:"gray",children:o._("This helps people using screen readers understand what your Pin is about.","EditPinModal.EditAltText","Label for editing alt text of pin")})})})})]}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i})})})]})]})}var k=i("V711"),P=i("wm0H"),D=i("QAzJ");function M({board:e={},canEdit:t,onBoardChange:i,onBoardCreate:n}){const o=Object(d.c)(),{anyEnabled:r}=Object(D.b)("web_boardless_pins")({dangerouslySkipActivation:!0}),{showEnabledSaveBehavior:s}=Object(P.a)(),a="quick_saves"===e.layout&&(r||s);return Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"BoardPicker",children:Object(c.jsx)(l.bb,{size:"md",children:o._("Board")})})}),t?Object(c.jsx)(l.f,{column:12,mdColumn:8,children:Object(c.jsx)(k.a,{board:e,isBoardlessPinsBoard:a,onBoardChosen:i,onBoardCreate:n})}):e.name&&Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:e.name})})]})}var B=i("TSYQ"),T=i.n(B),R=i("JKZO"),L=i("Q7uW"),A=i("U4JR");function N(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class U extends n.Component{constructor(...e){super(...e),N(this,"state",{focused:!1}),N(this,"suggestionAnchorRef",Object(n.createRef)()),N(this,"setRef",e=>this.textAreaRef=e),N(this,"handleBlur",e=>{this.setState({focused:!1});const{onBlur:t}=this.props;t&&t(e)}),N(this,"handleFocus",e=>{this.setState({focused:!0});const{onFocus:t}=this.props;t&&t(e)}),N(this,"handleChange",({text:e,mentions:t})=>{this.props.onDescriptionChange({value:e,userMentionTags:t})})}render(){const{canAddUserMentionTags:e,canEdit:t,description:i,errorMessage:o,initialMentions:r,label:s,placeholder:a,onDescriptionChange:d}=this.props,{focused:u}=this.state;return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"DescriptionField",children:Object(c.jsx)(l.bb,{size:"md",children:s})})}),t?Object(c.jsxs)(l.f,{column:12,mdColumn:8,children:[Object(c.jsx)(l.f,{children:e?Object(c.jsx)("div",{className:T()("DescriptionField",{DescriptionField__error:!!o,DescriptionField__focus:u}),id:"DescriptionField",ref:this.suggestionAnchorRef,role:"textbox",children:Object(c.jsx)(R.a,{initialMentions:r,initialText:i,onAddMention:()=>{Object(A.b)(8905,{element:116,tag_type:1})},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onSearchMentionCancel:()=>{Object(A.b)(8908,{element:116,tag_type:1})},onSuggestionsPopoverOpen:()=>{Object(A.b)(8907,{element:116,tag_type:1})},maxSuggestions:4,placeholder:a})}):Object(c.jsx)(l.cb,{id:"DescriptionField",placeholder:a,value:i,onChange:({value:e})=>{d({value:e,userMentionTags:[]})},hasError:(o||"").length>0})}),!!o&&Object(c.jsx)(l.f,{children:Object(c.jsx)(L.a,{errorMessage:o,htmlFor:"pin-edit-description"})})]}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i})})]})]})}}var F=U,z=i("VJm5"),H=i("rSLd"),V=i("xOLo");function W({isCarousel:e,onMouseEnter:t,onMouseLeave:i,shouldShowCarouselSliders:n,onCarouselSlide:o,currentIndex:r,carouselData:s,pinId:a,description:d,image:u={}}){return Object(c.jsxs)(l.f,{paddingX:4,paddingY:3,children:[e&&(()=>{const e=s&&s.carousel_slots&&s.carousel_slots.length||1;return e>=2&&Object(c.jsx)(l.f,{padding:2,children:Object(c.jsx)(l.z,{htmlFor:"CardsIndex",children:Object(c.jsxs)(l.bb,{size:"md",children:[r+1,"/",e]})})})})(),Object(c.jsx)(l.D,{width:236,children:Object(c.jsxs)(l.f,{onMouseEnter:t,onMouseLeave:i,children:[Object(c.jsxs)(l.D,{rounding:2,wash:!0,children:[e&&n&&Object(c.jsx)(l.f,{width:"100%",height:"100%",display:"inlineBlock",position:"absolute",dangerouslySetInlineStyle:{__style:{zIndex:10,background:"rgba(0, 0, 0, 0.3)"}},children:Object(c.jsx)(V.default,{handleCarouselSwipe:o,carouselIndex:r,carouselData:s,pinId:a,isEditMode:!0})}),e?Object(c.jsx)(z.a,{carouselIndex:r,isCloseup:!1,carouselData:s,pinId:a,isEditMode:!0}):Object(c.jsx)(l.y,{alt:d,color:"#efefef",naturalHeight:u.height,src:u.url,naturalWidth:u.width})]}),e&&Object(c.jsx)(H.default,{carouselIndex:r,carouselData:s,pinId:a,handleCarouselSwipe:o,isEditMode:!0,variant:"legacy"})]})})]})}function K({apiErrorMessage:e,shouldShowGenericUpdateError:t,onClickDeleteButton:i,disableDelete:n,onHide:o,shouldDisableSave:r,triggerBoardAndSectionCreate:s}){const a=Object(d.c)();return Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[Object(c.jsx)(_.a,{id:"delete-pin-button",children:Object(c.jsx)(l.g,{fullWidth:!0,text:a._("Delete","EditPinModal.EditPinFooter.Delete","delete pin"),onClick:i,disabled:n})}),t&&Object(c.jsx)(l.f,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:Object(c.jsx)(L.a,{errorMessage:e||a._("Sorry! There was an error editing your Pin.","EditPinModal.EditPinFooter.ErrorMessageToast","Toast for pin edit error"),htmlFor:"pin-edit-generic-error"})}),Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[Object(c.jsx)(l.f,{paddingX:2,children:Object(c.jsx)(l.g,{fullWidth:!0,text:a._("Cancel","EditPinModal.EditPinFooter.Cancel","cancel changes"),onClick:o})}),Object(c.jsx)(l.f,{paddingX:2,"data-test-id":"edit-pin-save",children:Object(c.jsx)(l.g,{fullWidth:!0,text:a._("Save","EditPinModal.EditPinFooter.Save","save changes"),color:"red",onClick:s,disabled:r})})]})]})}function Y({pinNoteText:e,isCollaborative:t,onPinNoteChange:i}){const o=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"PinNoteField",children:Object(c.jsx)(l.bb,{size:"md",children:t?o._("Note to group","editPinModal.editPinNote.groupTitle","Label for editing private note on group Pin"):o._("Note to self","editPinModal.editPinNote.title","Label for editing private note on Pin")})})}),Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.cb,{errorMessage:e.length>=500?o._("Character limit reached","editPinModal.editPinNote.warningText","Text to inform user they have reached the length limit on Pin note"):void 0,id:"PinNoteField",onChange:i,placeholder:o._("Add a private note to remember your ideas about this Pin","editPinModal.editPinNote.placeholderText","Placeholder for editing private note"),value:e})})]})]})}var q=i("NXrh");function Q({board:e,canEdit:t,currentSection:i,onSectionChange:n,onSectionCreate:o,sectionId:r,sectionName:s}){const a=Object(d.c)(),u=null!=e&&e.id?q.b:q.a;return Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:3,children:Object(c.jsx)(l.z,{htmlFor:"SectionPicker",children:Object(c.jsx)(l.bb,{size:"md",children:a._("Section","label for editing a Pin's board section","label for editing a Pin's board section")})})}),t&&e?Object(c.jsx)(l.f,{column:12,mdColumn:8,children:Object(c.jsx)(u,{board:e,onSectionChange:n,selectedSectionId:r,selectedSectionName:s,onSectionCreate:o})}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i&&!(e||{}).is_collaborative?i.title:a._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")})})]})}var G=i("VBRM"),X=i("8Enz"),J=i("kT2/"),Z=i("6HHy"),$=i("1RGD");function ee({keyValueBlocks:e,listBlocks:t,onUpdateKeyValueBlock:i,onUpdateListBlocks:o,templateType:r}){const s=Object(d.c)();return Object(c.jsxs)(l.f,{children:[1===r&&Object(c.jsxs)(n.Fragment,{children:[Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:s._("Cook time","editModal.editStoryPinModal.details.cookTime","Label for cook time detail")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)($.a,{onUpdate:e=>i(0,e),value:e[0]||null})})]},"cooktime"),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:s._("Servings","editModal.editStoryPinModal.details.servings","Label for serving size detail")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(Z.a,{showLabel:!1,onUpdate:e=>i(1,e),value:e[1]||null})})]},"servingSize")]}),2===r&&Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:s._("Difficulty","editModal.editStoryPinModal.details.difficulty","Label for difficulty level detail")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(X.a,{showLabel:!1,onUpdate:e=>i(2,e),value:e[2]||null})})]},"difficulty"),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:(()=>{switch(r){case 1:return s._("Ingredients","editModal.editStoryPinModal.listHeading","Heading for an ingredients list");case 2:return s._("Supplies","editModal.editStoryPinModal.listHeading","Heading for a supplies list");default:return s._("What they'll need","editModal.editStoryPinModal.listHeading","Heading for a generic list")}})()}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(J.a,{listBlocks:t,onUpdate:o})})]})]})}var te=i("ESls"),ie=i("Joxa");var ne=i("vvax"),oe=i("MNxV");var re=Object(o.connect)(()=>({}),e=>({completeResourceFetch:t=>e(Object(f.b)("PinResource",{field_set_key:"detailed",id:t.id},t)),invalidatePin:t=>e(Object(f.f)("PinResource",{field_set_key:"detailed",id:t}))}))((function({apiErrorMessage:e,board:t,completeResourceFetch:i,commentsDisabled:o,description:r,disableDelete:s,invalidatePin:a,isLoadingPin:h,isProcessing:p,onChangeBoard:f,onChangeComment:j,onChangeSection:g,onClickBoardCreate:m,onClickDeleteButton:x,onClickEditPages:_,onClickSectionCreate:O,onHide:v,pinResource:S,sectionId:C,sectionName:w,title:I,triggerBoardAndSectionCreate:E}){var P,M;const B=Object(d.c)(),T=null!==(P=S.data)&&void 0!==P?P:{},R=T.story_pin_data,A=null!==(M=T.images&&T.images["474x"])&&void 0!==M?M:{},[N,U]=Object(n.useState)(!1),[F,z]=Object(n.useState)(null),[H,V]=Object(n.useState)(!1),[W,K]=Object(n.useState)({}),[Y,Q]=Object(n.useState)([]);Object(n.useEffect)(()=>{var e;const t=(null==R||null===(e=R.metadata)||void 0===e?void 0:e.basics)||null;if(t){const e=Object(ie.b)(t);K(e.keyValueBlocks||{}),Q(e.listBlocks||[])}},[R]),Object(n.useEffect)(()=>{e&&z(e)},[e]);const X=(e,t)=>{K({...W,[e]:t}),U(!0)},J=e=>{Q(e),U(!0)},{anyEnabled:Z}=Object(D.c)("web_story_pin_edit_deprecation"),{anyEnabled:$}=Object(D.c)("web_sp2s"),re=T.created_at?new Date(T.created_at):null,se=re&&Object(G.a)(re,14),ae=!Z&&!!se&&new Date<se,de=Y.length>0||Object.keys(W).length>0,le=$?Object(ne.b)(B._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Idea Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14}):Object(ne.b)(B._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Story Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14});return Object(c.jsx)(y.b,{accessibilityModalLabel:B._("Edit your previously saved pin","editModal.editStoryPinModal.accessibilityLabel","Accessible label for edit previously saved story pin modal"),footer:Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",children:[Object(c.jsx)(l.f,{"data-test-id":"delete-pin-button",children:Object(c.jsx)(l.g,{fullWidth:!0,color:"white",disabled:s,onClick:x,size:"lg",text:B._("Delete","editModal.editStoryPinModal.deleteButton","Delete button for previously saved story pin")})}),!!F&&Object(c.jsx)(l.f,{display:"flex",justifyContent:"center",children:Object(c.jsx)(L.a,{errorMessage:F,htmlFor:"pin-edit-generic-error"})}),Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",marginEnd:-1,marginStart:-1,children:[Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{fullWidth:!0,onClick:v,size:"lg",text:B._("Cancel","editModal.editStoryPinModal.cancelButton","Cancel button to not save edits to previously saved story pin")})}),Object(c.jsx)(l.f,{"data-test-id":"edit-pin-save",paddingX:1,children:Object(c.jsx)(l.g,{fullWidth:!0,color:"red",onClick:()=>{if(N&&R){V(!0);const e=Object(ie.c)({keyValueBlocks:W,listBlocks:Y}),t=function(e){var t,i,n,o,r,s,a;return{metadata:{basics:null!==(t=e.metadata)&&void 0!==t&&t.basics?Object(ie.a)(e.metadata.basics):void 0,diy_data:null===(i=e.metadata)||void 0===i?void 0:i.diy_data,pin_image_signature:null===(n=e.metadata)||void 0===n?void 0:n.pin_image_signature,pin_title:null===(o=e.metadata)||void 0===o?void 0:o.pin_title,recipe_data:null===(r=e.metadata)||void 0===r?void 0:r.recipe_data,template_type:null===(s=e.metadata)||void 0===s?void 0:s.template_type},pages:(a=e.pages,(null!=a?a:[]).map(e=>{var t,i;const n=(null!==(t=e.blocks)&&void 0!==t?t:[]).map(e=>{switch(e.type){case"story_pin_paragraph_block":return{block_style:e.block_style,style:e.style,text:e.text,type:0};case"story_pin_heading_block":return{block_style:e.block_style,level:e.level,style:e.style,text:e.text,type:1};case"story_pin_image_block":return{block_style:e.block_style,image_signature:e.image_signature,tracking_id:e.tracking_id,type:2};case"story_pin_video_block":return{block_style:e.block_style,tracking_id:e.tracking_id,type:3,video_signature:e.video_signature};default:return null}}).filter(Boolean);return n.length>0?{blocks:n,layout:e.layout,style:null!==(i=e.style)&&void 0!==i&&i.background_color?{background_color:e.style.background_color}:void 0}:null}).filter(Boolean))}}(R),n={...t,metadata:{...t.metadata,basics:e}},o={pin_id:T.id,story_pin:JSON.stringify(n)};b.a.create("StoryPinEditResource",o).callUpdate().then(e=>{const{resource_response:t}=e;a(T.id),i(t.data),E()}).catch(e=>{z(e.message),V(!1)})}else E()},size:"lg",text:B._("Done","editModal.editStoryPinModal.doneButton","Done button to save edits to previously saved story pin")})})]})]}),heading:B._("Edit Pin","editModal.editStoryPinModal.heading","Edit a previously saved story pin"),onDismiss:v,size:"md",children:h||!S.isLoaded||H||p?Object(c.jsx)(l.f,{paddingX:12,paddingY:9,children:Object(c.jsx)(l.U,{accessibilityLabel:B._("Loading edit information","editPinModal.editStoryPinModal.spinner","Accessible label for the edit pin loading icon"),show:!0})}):Object(c.jsx)(l.f,{overflow:"hidden",children:Object(c.jsx)(l.f,{marginEnd:-4,marginStart:-4,children:Object(c.jsx)(te.a,{name:"web_story_pin_limit_edits",children:({anyEnabled:e})=>{var i,s,a,d,h,b;return Object(c.jsxs)(l.f,{display:"flex",minHeight:300,overflow:"hidden",paddingX:8,children:[Object(c.jsxs)(l.f,{alignItems:"center",direction:"column",display:"flex",flex:"shrink",paddingX:4,children:[Object(c.jsxs)(l.D,{wash:!0,rounding:4,width:120,children:[Object(c.jsx)(l.y,{alt:r,color:"#efefef",naturalHeight:null!==(i=A.height)&&void 0!==i?i:1,naturalWidth:null!==(s=A.width)&&void 0!==s?s:1,src:null!==(a=A.url)&&void 0!==a?a:""}),Object(c.jsx)(l.f,{position:"absolute",left:!0,top:!0,padding:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"center",opacity:.8,padding:2,rounding:"pill",children:[Object(c.jsx)(l.w,{accessibilityLabel:$?B._("Idea Pin icon","editModal.editStoryPinModal.storyPinIndicator","Idea Pin icon indicator"):B._("Story Pin icon","editModal.editStoryPinModal.storyPinIndicator","Story Pin icon indicator"),color:"darkGray",icon:"story-pin",size:12}),Object(c.jsx)(l.f,{marginStart:1,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:null===(d=T.story_pin_data)||void 0===d?void 0:d.page_count})})]})})]}),ae||!e?Object(c.jsx)(l.f,{"data-test-id":"edit-pages-button",paddingY:2,children:Object(c.jsx)(l.g,{onClick:_,text:B._("Edit pages","editModal.editStoryPinModal.editPagesButton","Edit pages label for story pin creation entry point")})}):null]}),Object(c.jsx)(l.f,{direction:"column",display:"flex",flex:"grow",paddingX:4,children:Object(c.jsx)(l.f,{marginBottom:-2,marginTop:-2,children:Object(c.jsx)(l.f,{maxHeight:500,overflow:"auto",paddingX:1,children:Object(c.jsxs)(l.f,{maxWidth:504,children:[e&&se&&Object(c.jsx)(l.f,{paddingY:2,children:ae?Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.bb,{size:"md",children:Object(ne.b)(B._("Edit until {{ editDate }}","editModal.editStoryPinModal.lastEditableDate","Let user know the last date this Pin can be edited on"),{editDate:Object(c.jsx)(oe.b,{dateFormatType:oe.a.NUMERIC,useUTC:!1,value:se},"noEditsTwoWeeksAfter-"+(null!==(h=T.created_at)&&void 0!==h?h:""))})}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(l.bb,{color:"gray",size:"md",children:le})})]}):Object(c.jsxs)(l.f,{children:[Object(c.jsx)(l.bb,{size:"md",children:B._("Editing","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",color:"gray",children:B._("Only board selection and engagement settings can be changed!","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")})})]})}),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:B._("Title","editModal.editStoryPinModal.titleLabel","Label for form input where users will input the title of their pin")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"between",padding:4,rounding:4,children:[Object(c.jsx)(l.bb,{color:"gray",truncate:!0,children:I||""}),Object(c.jsx)(l.w,{accessibilityLabel:B._("Lock","editModal.editStoryPinModal.lockIcon.accessibilityLabel","Label for the lock icon to show that editing a story pin title is locked"),color:"darkGray",icon:"lock"})]})})]}),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:B._("Board","editModal.editStoryPinModal.boardLabel","Label for dropdown where users will choose their board")}),Object(c.jsx)(l.f,{paddingY:2,children:t?Object(c.jsx)(k.a,{board:t,isStoryPin:!0,onBoardChosen:f,onBoardCreate:m}):null})]}),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:B._("Section","editModal.editStoryPinModal.sectionLabel","Label for dropdown where users will choose their section")}),Object(c.jsx)(l.f,{paddingY:2,children:(null==t?void 0:t.id)&&Object(c.jsx)(q.b,{isStoryPin:!0,board:t,onSectionChange:g,onSectionCreate:O,selectedSectionId:C,selectedSectionName:w})})]}),e&&de&&ae&&Object(c.jsx)(ee,{keyValueBlocks:W,listBlocks:Y,onUpdateKeyValueBlock:X,onUpdateListBlocks:J,templateType:null==R||null===(b=R.metadata)||void 0===b?void 0:b.template_type}),T.can_delete_did_it_and_comments&&Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:B._("Comments and photos permissions","editModal.editStoryPinModal.commentsAndPhotosPermissionsLabel","Label for dropdown where users can toggle off permissions for comments and photos")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(u,{isNoTitle:!0,commentsDisabled:o,onCommentChange:j})})]})]})})})})]})}})})})})}));function se({canEdit:e,onTitleChange:t,title:i,errorMessage:o}){const r=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"TitleField",children:Object(c.jsx)(l.bb,{size:"md",children:r._("Title","Label for editing title of pin","Label for editing title of pin")})})}),Object(c.jsx)(l.f,{column:12,mdColumn:8,children:e?Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.f,{children:Object(c.jsx)(l.db,{hasError:(o||"").length>0,id:"TitleField",onChange:t,size:"lg",value:i})}),!!o&&Object(c.jsx)(l.f,{children:Object(c.jsx)(L.a,{errorMessage:o,htmlFor:"pin-edit-title"})})]}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i})})})]})]})}function ae({onChangeWebsite:e,link:t,errorMessage:i}){const o=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"WebsiteField",children:Object(c.jsx)(l.bb,{size:"md",children:o._("Website")})})}),Object(c.jsxs)(l.f,{column:12,mdColumn:8,children:[Object(c.jsx)(l.f,{children:Object(c.jsx)(l.db,{hasError:(i||"").length>0,id:"WebsiteField",onChange:e,size:"lg",value:t})}),!!i&&Object(c.jsx)(l.f,{children:Object(c.jsx)(L.a,{errorMessage:i,htmlFor:"pin-edit-website"})})]})]})]})}var de=i("MhBu"),le=i("x12c"),ce=i("Wrea"),ue=i("sH+O"),he=i("OSge"),be=i("KFEb"),pe=i("r8eU"),fe=i("qVfT"),je=i("NjDU"),ge=i("w70y"),me=i("eIuQ"),ye=i("pLLR"),xe=i("ANjH"),_e=i("c50B"),Oe=i("VqlB"),ve=i("EC67");function Se(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ce(e){return Boolean(e&&e.trim().length)}function we(e,t){const i=Ce(e),n=Ce(t);return(i||n)&&e!==t}class Ie extends n.Component{constructor(...e){var t,i,n,o,r,s,d,l,c,u,p,f,j,g,y,x,_,O;super(...e),Se(this,"state",{altText:(null===(t=this.props.pinResource.data)||void 0===t?void 0:t.alt_text)||"",board:(null===(i=this.props.pinResource.data)||void 0===i?void 0:i.board)||null,commentsDisabled:(null===(n=this.props.pinResource.data)||void 0===n?void 0:n.comments_disabled)||(null===(o=this.props.pinResource.data)||void 0===o?void 0:o.did_it_disabled)||!1,description:(null===(r=this.props.pinResource.data)||void 0===r||null===(s=r.description)||void 0===s?void 0:s.trim())||"",apiErrorMessage:null,link:(null===(d=this.props.pinResource.data)||void 0===d?void 0:d.link)||"",pinNoteText:(null===(l=this.props.pinResource.data)||void 0===l||null===(c=l.pin_note)||void 0===c?void 0:c.text)||"",sectionId:(null===(u=this.props.pinResource.data)||void 0===u||null===(p=u.section)||void 0===p?void 0:p.id)||null,sectionName:(null===(f=this.props.pinResource.data)||void 0===f||null===(j=f.section)||void 0===j?void 0:j.title)||null,showDeleteConfirmation:!1,carousel_data:(null===(g=this.props.pinResource.data)||void 0===g?void 0:g.carousel_data)||null,title:(null===(y=this.props.pinResource.data)||void 0===y?void 0:y.title)||"",isLoadingPin:!Boolean(this.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==this.props.carouselSlotCurrentIndex?this.props.carouselSlotCurrentIndex:(null===(x=this.props.pinResource.data)||void 0===x||null===(_=x.carousel_data)||void 0===_?void 0:_.index)||0,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(O=this.props.pinResource.data)||void 0===O?void 0:O.user_mention_tags)||[]}),Se(this,"onClickDeleteButton",()=>this.setState({showDeleteConfirmation:!0})),Se(this,"onHideConfirmation",()=>this.setState({showDeleteConfirmation:!1})),Se(this,"updateCarouselSlotIndex",()=>{const{carouselSlotCurrentIndex:e}=this.props;this.setState({currentIndex:void 0!==e?e:this.props.pinResource.data&&this.props.pinResource.data.carousel_data&&this.props.pinResource.data.carousel_data.index||0})}),Se(this,"handleBoardChange",e=>{const{board:{id:t}}=this.state;e.id!==t&&this.setState({board:e,sectionId:null,sectionName:null})}),Se(this,"createBoard",e=>{const{createBoard:t}=this.props,{board:i}=this.state;!i.id&&i.name&&e&&t(i.name,e).then(e=>{if(this._isMounted){const{sectionId:t,sectionName:i}=this.state;!t&&i?(this.setState({board:e}),this.createSection()):(this.handleBoardChange(e),this.handleSave())}})}),Se(this,"handleBoardCreateClick",e=>{if(!e)return;const t={name:e,privacy:h.a.BoardPrivacy.PUBLIC,access:"write"};this.setState({board:t,sectionId:null,sectionName:null})}),Se(this,"createSection",()=>{const{board:e,sectionName:t}=this.state;if(!t)return;if(!e.id)return void this.createBoard();const i={boardId:e.id,name:t},{createSection:n}=this.props;n(i).then(e=>{this._isMounted&&(this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),this.handleSave())}).catch(()=>{this.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})})}),Se(this,"handleSectionCreateClick",e=>{if(0===e.length)return;const{board:t}=this.state;t&&this.setState({sectionId:null,sectionName:e})}),Se(this,"handleSectionChange",e=>this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1})),Se(this,"handleDeletePin",()=>{const{advertiser_id:e,changeBoardPinCount:t,changeUserPinCount:i,onDelete:n,onHide:o,pinId:r,pinResource:{data:s},removeBoardlessPin:a,viewer:d}=this.props,l={...e?{advertiser_id:e}:{},id:r};return b.a.create("PinResource",l).callDelete().then(()=>{if(this._isMounted){if(!s)return;const{board:{id:e}={},pinner:{id:a}={},section:d}=s;t({boardId:e,sectionId:d&&d.id||void 0,increment:-1}),i({userId:a,increment:-1}),le.a.instance.publish(e,"pinDeleted",r),le.a.instance.publish(a,"pinDeleted"),le.a.instance.publish(r,"pinDeleted"),o(),n&&n()}d.id&&a(d.id,r)})}),Se(this,"sanitizeCarouselData",e=>{let{carousel_data:t}=this.state;if(e&&(t=e),t){const{carousel_slots:e}=t;if(e){const t={carousel_slots:[]};return e.forEach(e=>{const i={};i.description=e.details||"",i.title=e.title||"",i.link=e.link||"",t.carousel_slots.push(i)}),t}}return null}),Se(this,"triggerBoardAndSectionCreate",e=>()=>{const{board:t,sectionId:i,sectionName:n}=this.state;t&&!t.id&&t.name?this.createBoard(e):!i&&n?this.createSection():this.handleSave()}),Se(this,"logPinEditEvent",(e,t,i,n,o)=>{const r={},{pinId:s,view:a,viewParameter:d}=this.props,{userMentionTags:l}=this.state;if(r.objectId=s,r.num_user_mention_tags=l.length,e&&(r.board_was_modified=!0),!e&&t&&(r.board_section_was_modified=!0),i){const{description:e}=this.state,{description:t}=o;r.original_pin_description=t,r.edited_pin_description=e}if(n){const{carousel_data:e}=this.state,{carousel_data:t}=o;r.original_carousel_data=JSON.stringify(this.sanitizeCarouselData(t)),r.edited_carousel_data=JSON.stringify(this.sanitizeCarouselData(e))}Object(A.b)(2,{component:208,view:a,viewParameter:d,...r})}),Se(this,"handleSave",()=>{this.setState({apiErrorMessage:null,isProcessing:!0});const{advertiser_id:e,completeResourceFetch:t,invalidatePinResource:i,pinId:n,pinResource:{data:o},onHide:r,removeBoardlessPin:s,updatePinNote:a,viewer:d}=this.props;if(!o)return;const{alt_text:l,board:c,comments_disabled:u,did_it_disabled:h,title:p,description:f,link:j,pin_note:g,section:y,carousel_data:x}=o,_=null==g?void 0:g.text,{carousel_data:O,shouldShowValidationLinkFormatError:v}=this.state;let S;if(O){const e=this.sanitizeCarouselData();e&&(S=JSON.stringify(e))}const{altText:C,board:w,commentsDisabled:I,currentIndex:E,title:k,description:P,pinNoteText:D,sectionId:M,carousel_data:B,userMentionTags:T}=this.state,R=w||c,L=v?j:this.state.link,A={alt_text:C,board_id:null==R?void 0:R.id,board_section_id:M,carousel_data_json:S,description:P,disable_comments:I,disable_did_it:I,id:n,link:L,title:k,user_mention_tags:JSON.stringify(T),...e?{advertiser_id:e}:{}},N=y&&y.id||null,U=null==R?void 0:R.id,F=null==c?void 0:c.id,z=we(l,C),H=F!==U,V=(Boolean(N)||Boolean(M))&&N!==M,W=we(p,k),K=we(f,P),Y=we(j,L),q=Boolean(B)&&Boolean(x)&&!m()(B,x),Q=u!==I||h!==I,G=we(_,D);z||H||V||W||K||G||Y||q||Q?(G&&a(n,_,D),b.a.create("PinResource",A).callUpdate().then(({resource_response:e})=>{if(this._isMounted){const{changeBoardPinCount:l,onSubmit:c,pinId:u,pinMoved:h}=this.props;var n,a;if((H||V)&&U&&F)h({selectedPinIds:[u],source:{boardId:F,sectionId:N},target:{boardId:U,sectionId:M}}),l({boardId:U,sectionId:M||void 0,increment:1}),l({boardId:F,sectionId:N||void 0,increment:-1}),d.id&&"quick_saves"===(null===(n=o.board)||void 0===n?void 0:n.layout)&&s(d.id,u);if(c&&U&&null!=R&&R.url)c({boardId:U,title:null!==(a=R.name)&&void 0!==a?a:"",sectionId:M,url:R.url});r(),i(u);const{data:b}=e;b.carousel_data&&(b.carousel_data.index=E),t(b),this.logPinEditEvent(H,V,K,q,o)}}).catch(()=>{const{shouldShowValidationTitleError:e,shouldShowValidationDescriptionError:t,shouldShowValidationLinkFormatError:i}=this.state;this.setState({isProcessing:!1,shouldShowGenericUpdateError:!e&&!t&&!i})})):(r(),i(n)),this.setState({isProcessing:!1})}),Se(this,"handleTextChanges",(e,t)=>{const{carousel_data:i}=this.state;if(!i)return;const n=a()(i),{carousel_slots:o=[]}=n,{currentIndex:r,shouldApplyTextToAll:s,description:d,link:l,title:c}=this.state,u=this.valueIsValidForType(e,t);switch(s?o.forEach(i=>i[t]=e):o[r]&&(o[r][t]=e),t){case"details":const t=0===r?e:d;this.setState({description:t,carousel_data:n||null,shouldShowValidationDescriptionError:!u,shouldShowGenericUpdateError:!1});break;case"link":const i=0===r?e:l;this.setState({link:i,carousel_data:n||null,shouldShowValidationLinkFormatError:!u,shouldShowGenericUpdateError:!1});break;case"title":const o=0===r?e:c;this.setState({title:o,carousel_data:n||null,shouldShowValidationTitleError:!u,shouldShowGenericUpdateError:!1})}}),Se(this,"handleDescriptionChange",({value:e,userMentionTags:t})=>{const i=this.valueIsValidForType(e,"description"),n=this.valueIsValidForType(t,"userMentionTags");t.length<this.state.userMentionTags.length&&Object(A.b)(8906,{element:116,tag_type:1}),this.setState({description:e,userMentionTags:t,shouldShowValidationDescriptionError:!i,shouldShowValidationUserMentionTagsError:!n,shouldShowGenericUpdateError:!1})}),Se(this,"handleCarouselDetailsChange",({value:e})=>{this.handleTextChanges(e,"details")}),Se(this,"handleTitleChange",({value:e})=>{const t=this.valueIsValidForType(e,"title");this.setState({title:e,shouldShowValidationTitleError:!t,shouldShowGenericUpdateError:!1})}),Se(this,"handleCarouselTitleChange",({value:e})=>{this.handleTextChanges(e,"title")}),Se(this,"handleAltTextChange",({value:e})=>{this.setState({altText:e})}),Se(this,"valueIsValidForType",(e,t)=>{switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===Object(_e.s)([Object(_e.r)({message:this.props.i18n._("Not a valid url.","Validation error for an improperly formated url","Validation error for an improperly formated url")})],e).length;case"title":return e.length<=100;case"userMentionTags":return e.length<=5;default:return!0}}),Se(this,"handleWebsiteChange",({value:e})=>{const t=this.valueIsValidForType(e,"link");this.setState({link:e,shouldDisableSave:!t,shouldShowValidationLinkFormatError:!t,shouldShowGenericUpdateError:!1})}),Se(this,"handleCarouselWebsiteChange",({value:e})=>{this.handleTextChanges(e,"link")}),Se(this,"handleCommentChange",e=>this.setState({commentsDisabled:!e.value})),Se(this,"handleShouldApplyToAll",e=>{if(e){const{currentIndex:t=0,carousel_data:i}=this.state;if(!i)return;const n=a()(i),{carousel_slots:o=[]}=n,{details:r,link:s,title:d}=o[t];o.forEach(e=>{e.details=r,e.title=d,e.link=s}),this.setState({carousel_data:n,shouldApplyTextToAll:e})}else this.setState({shouldApplyTextToAll:e})}),Se(this,"handleCarouselSlider",e=>{const{carousel_data:t}=this.state,i=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<i&&this.setState({currentIndex:e})}),Se(this,"handleClickStoryPinPages",()=>{const{pinResource:{data:e},history:t}=this.props;e&&t.push(`/story-pin-builder/${e.id}/edit`)}),Se(this,"handleMouseEnter",()=>{this.setState({shouldShowCarouselSliders:!0})}),Se(this,"handleMouseLeave",()=>{this.setState({shouldShowCarouselSliders:!1})})}componentDidMount(){this._isMounted=!0,this.updateCarouselSlotIndex()}componentDidUpdate(e){const{pinResource:{data:t,isLoaded:i},carouselSlotCurrentIndex:n}=this.props;var o;t&&i!==e.pinResource.isLoaded&&this.setState({altText:t.alt_text,board:t.board,commentsDisabled:t.comments_disabled||t.did_it_disabled,description:t.description&&t.description.trim(),isLoadingPin:!1,link:t.link,pinNoteText:(null===(o=t.pin_note)||void 0===o?void 0:o.text)||"",sectionId:(t.section||{}).id,sectionName:(t.section||{}).title,title:t.title,carousel_data:t.carousel_data,currentIndex:void 0!==n?n:t.carousel_data&&t.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:t.user_mention_tags||[]})}componentWillUnmount(){this._isMounted=!1}showErrorToast(e){this.props.toastManagerContext.showOneToast(({onHide:t})=>Object(c.jsx)(O.a,{color:"red",duration:5e3,onHide:t,text:e})),this.props.onHide()}getCurrentUserId(e){return e.isAuth?e.id:""}render(){const{disableDelete:e,onHide:t,pinResource:i,pinId:n,requestContext:o,viewer:s}=this.props,{altText:a,apiErrorMessage:d,board:h,commentsDisabled:b,description:p,link:f,pinNoteText:j,sectionId:g,sectionName:m,showDeleteConfirmation:x,title:_,isLoadingPin:O,isProcessing:v,carousel_data:S,shouldApplyTextToAll:C,currentIndex:w,shouldDisableSave:k,shouldShowCarouselSliders:P,shouldShowValidationTitleError:D,shouldShowValidationDescriptionError:B,shouldShowValidationLinkFormatError:T,shouldShowGenericUpdateError:R,shouldShowValidationUserMentionTagsError:L,userMentionTags:A}=this.state;if(x)return Object(c.jsx)(I,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation});const N=i.data||{},U=!!(S&&S.carousel_slots&&S.carousel_slots.length>1),z=S&&S.carousel_slots&&S.carousel_slots.length>0&&S.carousel_slots[w]||{},{details:H="",link:V="",title:q=""}=z,G=!!(N&&N.story_pin_data_id&&N.story_pin_data),X=N&&(N.access||[]).includes("write")||this.props.canEdit||!!h&&Object(r.a)({action:4,board:h}),J=e=>{const t=this.getCurrentUserId(e),i=this.props.canEdit&&this.props.advertiserOwnerUserId?this.props.advertiserOwnerUserId:t;return X&&!N.is_repin&&!G&&(U||!S)&&(N.native_creator&&N.native_creator.id===i||U&&N.pinner&&N.pinner.id===i||N.link_domain&&N.link_domain.official_user&&N.link_domain.official_user.id===i||!!N.domain&&N.pinner&&N.pinner.id===i&&N.pinner.domain_url&&N.pinner.domain_url.includes(N.domain))},Z=N&&N.images&&N.images["474x"]||{},$=new pe.b(o,"web_story_pin_creator").enabledWithNoActivation(),ee=new pe.b(o,"web_alt_text").enabledWithNoActivation(),te=N.story_pin_data&&N.story_pin_data.metadata&&N.story_pin_data.metadata.version?Object(ue.b)(N.story_pin_data.metadata.version,he.c):null,ie=null!=te&&te>=0,ne=!!N.story_pin_data&&!!N.story_pin_data.metadata&&!!N.story_pin_data.metadata.is_editable&&N.native_creator&&N.native_creator.id===this.getCurrentUserId(s);if(G&&$&&ie&&ne)return Object(c.jsx)(re,{apiErrorMessage:d,board:h,commentsDisabled:b,description:p,disableDelete:e,isLoadingPin:O,isProcessing:v,onChangeBoard:this.handleBoardChange,onChangeComment:this.handleCommentChange,onChangeSection:this.handleSectionChange,onClickBoardCreate:this.handleBoardCreateClick,onClickDeleteButton:this.onClickDeleteButton,onClickEditPages:this.handleClickStoryPinPages,onClickSectionCreate:this.handleSectionCreateClick,onHide:t,pinResource:i,sectionId:g,sectionName:m,title:_,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(s)});const oe=J(s)?Object(c.jsx)(se,{canEdit:X,onTitleChange:U?this.handleCarouselTitleChange:this.handleTitleChange,title:U&&q?q:_,errorMessage:D?Object(me.b)(U):""}):null,de=(X||s.isAuth&&(N.pinner||{}).id===s.id)&&J(s)?Object(c.jsx)(F,{canAddUserMentionTags:!U,canEdit:X,description:(U?H:p)||"",errorMessage:B?Object(me.a)(U):L?Object(me.d)(U):"",initialMentions:A,label:this.props.i18n._("Description","Label for editing description","Label for editing description"),placeholder:this.props.i18n._("Tell us about this Pin...","Placeholder for editing description","Placeholder for editing description"),onDescriptionChange:U?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,le=Object(c.jsx)(Y,{isCollaborative:!(null==h||!h.is_collaborative),onPinNoteChange:({value:e})=>{this.setState({pinNoteText:e})},pinNoteText:j}),ce=(e=>J(e)&&!(N.aggregated_pin_data&&N.aggregated_pin_data.is_shop_the_look))(s)?Object(c.jsx)(ae,{link:U&&V?V:f,onChangeWebsite:U?this.handleCarouselWebsiteChange:this.handleWebsiteChange,errorMessage:T?Object(me.c)(U):""}):null,be=U?Object(c.jsxs)(l.f,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"applyTextToAll",children:Object(c.jsx)(l.bb,{children:this.props.i18n._("Apply text to all","Apply title, description, link to all cards","Apply title, description, link to all cards")})})}),Object(c.jsx)(l.f,{paddingX:2,paddingY:2,children:Object(c.jsx)(l.W,{onChange:e=>this.handleShouldApplyToAll(e.value),id:"applyTextToAll",switched:C})})]}):null,fe=J(s)&&ee?Object(c.jsx)(E,{canEdit:X,onAltTextChange:this.handleAltTextChange,altText:a}):null,je=N.can_delete_did_it_and_comments?Object(c.jsx)(u,{commentsDisabled:b,onCommentChange:this.handleCommentChange}):null,ge=!!s.has_quicksave_board&&!!s.boardCount&&s.boardCount<2;return Object(c.jsx)(y.b,{heading:this.props.i18n._("Edit this Pin","EditPinModal.ModalHeading.EditThisPin","Edit a previously saved pin"),accessibilityModalLabel:this.props.i18n._("Edit your previously saved pin","EditPinModal.ModalHeading.AccessibleLabel","Accessible label for edit previously saved pin modal"),size:ge?"sm":"lg",onDismiss:t,footer:Object(c.jsx)(K,{apiErrorMessage:d,shouldShowGenericUpdateError:R,onClickDeleteButton:this.onClickDeleteButton,disableDelete:e,onHide:t,shouldDisableSave:k,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(s)}),children:O||!i.isLoaded||v?Object(c.jsx)(l.f,{display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.U,{accessibilityLabel:this.props.i18n._("loading","EditPinModal.LoadingPin.Spinner","Accessible label for the edit pin loading icon"),show:!0})}):Object(c.jsxs)(l.f,{display:"flex",justifyContent:ge?"center":"between",minHeight:350,paddingX:4,children:[ge?null:Object(c.jsxs)(l.f,{column:12,mdColumn:9,children:[Object(c.jsx)(M,{board:h||N.board,canEdit:X,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick}),Object(c.jsx)(Q,{board:h||N.board,canEdit:X,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:g,sectionName:m,currentSection:N.section}),oe,de,ce,be,fe,le,je]}),Object(c.jsx)(W,{isCarousel:U,shouldShowCarouselSliders:P,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:n,description:p,image:Z})]})})}}const Ee=(e,t)=>({field_set_key:"detailed",id:e,preserve_component_state:t});t.a=Object(xe.compose)(v.c,Object(o.connect)((function(e){const{advertiser:t,viewer:i}=e;return i.isAuth&&t?{advertiser_id:t.id,...t.owner_user_id!==i.id?{advertiserOwnerUserId:t.owner_user_id}:{},viewer:i}:{viewer:i}}),e=>({changeBoardPinCount:t=>e(Object(ce.d)(t)),changeUserPinCount:t=>e(Object(je.c)(t)),completeResourceFetch:t=>e(Object(f.b)("PinResource",Ee(t.id,!1),t)),createBoard:(t,i)=>e(function(e,t){const i={name:e,privacy:h.a.BoardPrivacy.PUBLIC};return e=>b.a.create("BoardResource",i).callCreate().then(i=>{const n=i.resource_response.data;return e(t.username&&Object(f.f)("BoardsResource",Object(p.a)(t.username,!1))),n})}(t,i)),createSection:t=>e(Object(j.a)(t)),invalidatePinResource:t=>e(Object(f.f)("PinResource",Ee(t,!0))),removeBoardlessPin:(t,i)=>e(Object(de.a)({feedId:t,feedType:be.a.BOARDLESS_PINS,itemIds:[i],itemType:"pin"})),pinMoved:Object(xe.bindActionCreators)(Oe.b,e),updatePinNote:(t,i,n)=>e(Object(fe.a)(t,i,n))})))((function(e){const t=Object(d.c)(),i=Object(ge.a)({name:"PinResource",options:Ee(e.pinId,!0)});return Object(c.jsx)(Ie,{...e,history:Object(ve.h)(),pinResource:i,requestContext:Object(ye.d)(),i18n:t})}))},"6HHy":function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("yweb"),o=i("vvax"),r=i("n6mq"),s=i("nKUr");function a({onUpdate:e,showLabel:t=!0,value:i}){const a=Object(n.c)(),d=[];for(let n=1;n<=50;n+=1)d.push({value:String(n),label:Object(o.b)(a.ngettext("{{ servings }} serving","{{ servings }} servings",n,"storyboard.detailsList.field.servings","Option for number of servings a story pin recipe will provide"),{servings:n}).join("")});return Object(s.jsx)(r.f,{width:"100%",display:"flex",children:Object(s.jsx)(r.f,{width:"100%",position:"relative",children:Object(s.jsx)(r.S,{size:"lg",id:"servings",name:"servings",label:t?a._("Servings","storyboard.detailsList.field.servings","Header title for serving count entry for story pin recipe"):void 0,placeholder:a._("Pick a serving size","storyboard.detailsList.recipe","Placeholder caption for servings count input in story pin recipe"),value:i,options:d,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},"8Enz":function(e,t,i){i.d(t,"a",(function(){return s}));var n=i("yweb"),o=i("n6mq"),r=i("nKUr");function s({onUpdate:e,showLabel:t=!0,value:i}){const s=Object(n.c)(),a=[{label:s._("Easy","storyboard.detailsList.field.difficulty","Easy difficulty rating for story pin"),value:String(1)},{label:s._("Medium","storyboard.detailsList.field.difficulty","Medium difficulty rating for story pin"),value:String(2)},{label:s._("Difficult","storyboard.detailsList.field.difficulty","Hard difficulty rating for story pin"),value:String(3)}];return Object(r.jsx)(o.f,{width:"100%",display:"flex",children:Object(r.jsx)(o.f,{width:"100%",children:Object(r.jsx)(o.S,{size:"lg",id:"servings",name:"servings",label:t?s._("Difficulty","storyboard.detailsList.field.difficulty","Header title for difficulty rating entry for story pin"):void 0,placeholder:s._("Pick a difficulty rating","storyboard.detailsList.field","Placeholder caption for difficulty rating input in story pin"),value:i,options:a,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},"8cMa":function(e,t,i){var n=i("yweb"),o=i("n6mq"),r=i("nKUr");t.a=function({type:e}){const t=Object(n.c)(),i={group:{accessibilityLabel:t._("group board","Board picker group board icon","Board picker group board icon"),icon:"people"},protected:{accessibilityLabel:t._("protected board","Board picker protected board icon","Board picker protected board icon"),icon:"protect"},secret:{accessibilityLabel:t._("secret board","Board picker secret board icon","Board picker secret board icon"),icon:"lock"},sections:{accessibilityLabel:t._("board with sections","Board picker board with sections icon","Board picker board with sections icon"),icon:"arrow-forward"},sectionsInline:{accessibilityLabel:t._("board with sections","Board picker board with sections icon","Board picker board with sections icon"),icon:"arrow-down"}}[e];return Object(r.jsx)(o.f,{marginStart:1,children:Object(r.jsx)(o.f,{marginStart:2,children:"sections"===e||"sectionsInline"===e?Object(r.jsx)(o.w,{accessibilityLabel:i.accessibilityLabel,icon:i.icon,size:"12",color:"darkGray"}):Object(r.jsx)(o.w,{accessibilityLabel:i.accessibilityLabel,icon:i.icon,size:16,color:"darkGray"})})})}},"9QW3":function(e,t,i){i.d(t,"a",(function(){return s}));const n={row:0,section:0},o={row:-1,section:-1},r=()=>{};class s{constructor(e){this.index=Object.assign({},n),this.sections=e,this.updateCallback=r,this.selectItem=r}getIndex(){return this.index}isAtStart(){const{row:e,section:t}=this.index;return 0===e&&0===t}isAtEnd(){const{row:e,section:t}=this.index,i=this.sections[t]||[];return this.sections.length===t+1&&i.length===e+1}next(){if(this.isAtEnd())return;const{row:e,section:t}=this.index;e===o.row&&t===o.section?this.index=Object.assign({},n):this.sections[t].length>e+1?this.index.row+=1:(this.index.section+=1,this.index.row=0),this.updateCallback(!0)}prev(){if(this.isAtStart())return;const{row:e,section:t}=this.index;if(e===o.row&&t===o.section)this.index=Object.assign({},n);else if(e>0)this.index.row-=1;else{const e=this.index.section-1;this.index={section:e,row:this.sections[e].length-1}}this.updateCallback(!0)}select(){const{row:e,section:t}=this.index;this.selectItem((this.sections[t]||[])[e])}setInactive(){this.index=Object.assign({},o),this.updateCallback()}setSelectItem(e){this.selectItem=e}setUpdateCallback(e){this.updateCallback=e}updateIndex(e){this.index=e,this.updateCallback()}}},GBVV:function(e,t,i){i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));var n=i("n6mq"),o=i("nKUr");const r={__style:{margin:"0 10px",borderRight:"3px solid transparent",borderTop:"3px solid #fff",animation:"spin .8s linear infinite"}};function s(){return Object(o.jsx)(n.f,{alignItems:"center",color:"red",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",rounding:8,children:Object(o.jsx)(n.f,{dangerouslySetInlineStyle:r,display:"inlineBlock",height:18,position:"relative",rounding:"circle",width:18})})}function a({disabled:e,name:t,onClick:i,size:r,submitting:a,text:d}){return Object(o.jsxs)(n.f,{display:"flex",position:"relative",children:[a&&Object(o.jsx)(s,{}),Object(o.jsx)(n.g,{color:"red",disabled:e||a,name:t,onClick:i,size:r,type:"submit",text:d})]})}},IBrh:function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("q1tI"),o=i("mEMi"),r=(i("9QW3"),i("n6mq")),s=i("nKUr");function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends n.Component{constructor(e){super(e),a(this,"setSelectedItemRef",e=>{this.selectedItemRef=e}),a(this,"handleIndexUpdate",e=>{const{indexManager:t}=this.props;this.setState({selectedIndex:t.getIndex(),selectionMovedByKeyboard:!!e})}),a(this,"handleSelectItem",e=>()=>{const{disabled:t,onSelectItem:i}=this.props;t||i(e)}),a(this,"handleMouseEnter",e=>()=>{const{disabled:t,indexManager:i}=this.props;t||i.updateIndex(e)}),a(this,"handleMouseLeave",()=>{const{disabled:e,indexManager:t}=this.props;e||t.setInactive()}),a(this,"renderItems",(e,t)=>{const{renderItem:i}=this.props,{selectedIndex:n}=this.state,{row:o,section:a}=n||{},{customProps:d={},items:l,renderItem:c}=e,{isDisabled:u=(e=>!1)}=d,h=t===a,b=c||i;return b&&l.map((e,i)=>{const n=u(e),a={section:t,row:i},l=h&&i===o;return Object(s.jsx)(r.f,{"data-test-id":"board-selection",ref:!n&&l?this.setSelectedItemRef:null,children:n?b({item:e,hovered:l,sectionProps:d}):Object(s.jsx)(r.ab,{fullWidth:!1,onMouseEnter:this.handleMouseEnter(a),onMouseLeave:this.handleMouseLeave,onTap:this.handleSelectItem(e),rounding:2,children:b({item:e,hovered:l,sectionProps:d})})},i)})}),a(this,"renderSections",()=>{const{renderSectionHeader:e,sections:t}=this.props;return t.map((t,i)=>Object(s.jsxs)(r.f,{children:[e&&e(t,i),this.renderItems(t,i)]},i))});const{indexManager:t}=this.props;this.state={selectedIndex:t.getIndex(),selectionMovedByKeyboard:!1},t.setUpdateCallback(this.handleIndexUpdate)}componentDidUpdate(e){const{containerRef:t}=this;if(this.selectedItemRef&&this.state.selectionMovedByKeyboard&&t){const e=this.selectedItemRef;if(!(e instanceof HTMLElement))return;const i=e.getBoundingClientRect(),n=i.top,o=i.bottom,r=t.getBoundingClientRect(),s=r.top;o>=r.bottom?e.scrollIntoView(!1):n<=s&&e.scrollIntoView(!0)}e.indexManager!==this.props.indexManager&&this.props.indexManager.setUpdateCallback(this.handleIndexUpdate)}render(){const{grow:e=!1,maxHeight:t,fetchMore:i}=this.props;return Object(s.jsx)(o.a,{fetchMore:i,children:({setRef:i,onScroll:n})=>Object(s.jsx)(r.f,{flex:e?"grow":void 0,height:e?"100%":void 0,maxHeight:t,onScroll:n,overflow:"auto",ref:e=>{this.containerRef=e,i(e)},children:this.renderSections()})})}}},JKZO:function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("2K7C"),o=i("MKeS"),r=i("nKUr"),s=i.n(r);const a=Object(o.a)({resolved:{},chunkName:()=>"EditorWithMentionsInternal",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!i.m[t]},importAsync:()=>i.e("EditorWithMentionsInternal").then(i.bind(null,"AO8i")),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return i(t)},resolve(){return"AO8i"}});function d(e){return Object(r.jsx)(a,{...e,fallback:Object(r.jsx)(n.a,{})})}},Joxa:function(e,t,i){i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return s}));const n=[0,2,1];function o(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map(e=>{const{heading:t,blocks:i}=e;return{heading:t,blocks:(null!=i?i:[]).map(e=>({text:e.text?e.text:"",type:9})),type:7}}):[];return{key_value_blocks:i&&i.length>0?i.map(e=>({category_type:e.category_type,type:8,value:e.value})):[],list_blocks:n}}function r(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map(e=>{const{heading:t,blocks:i}=e;return{heading:t,items:(null!=i?i:[]).map(e=>e.text?e.text:"")}}):[];return{keyValueBlocks:i&&i.length>0?i.reduce((e,t)=>{const{category_type:i,value:n}=t;return e[null!=i?i:""]=n,e},{}):{},listBlocks:n}}function s(e){const{keyValueBlocks:t,listBlocks:i}=e;if(!t&&!i)return null;return{list_blocks:i?i.map(e=>{const{heading:t,items:i}=e;let n=[];return i&&(n=i.map(e=>({text:e,type:9}))),{blocks:n,heading:t,type:7}}):[],key_value_blocks:(t?Object.keys(t).map(e=>{const i=t[e],o=Number.parseInt(e,10),r=n.indexOf(o)>-1&&i===Number.parseInt(i,10).toString();return i&&r?{value:i,category_type:o,type:8}:null}):[]).filter(Boolean)}}},NXrh:function(e,t,i){i.d(t,"a",(function(){return y}));var n=i("q1tI"),o=i("/MKj"),r=i("Sihc"),s=i("rrvb"),a=i("ANjH"),d=i("0BOE"),l=i("jdx6"),c=i("yweb"),u=i("n6mq"),h=i("w70y"),b=i("nKUr");function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const f="NO_SECTION_VALUE";function j({section:e,hovered:t,searchQuery:i}){return Object(b.jsxs)(u.f,{children:[Object(b.jsx)(u.f,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:Object(b.jsx)(u.f,{flex:"grow",children:Object(b.jsx)(u.bb,{weight:"bold",children:Object(l.b)(i,e.title)})})}),e.id===f&&Object(b.jsx)(u.q,{})]})}class g extends n.Component{constructor(...e){super(...e),p(this,"state",{searchQuery:""}),p(this,"getPickerSections",()=>{const{searchQuery:e}=this.state,{sectionsResource:t,mergingFromSectionId:i}=this.props;let n=t&&t.data||[];return n=i?n.filter(e=>e.id!==i):[{id:f,title:this.props.i18n._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")},...n],e.length>=2&&(n=Object(d.a)(n,e,"title")),[{items:n}]}),p(this,"createBtnDisabled",()=>{const{sectionsResource:e}=this.props,{searchQuery:t}=this.state;return!(!e||!e.data)&&e.data.some(e=>{var i;return(null===(i=e.title)||void 0===i?void 0:i.toLowerCase())===t.toLocaleLowerCase()})}),p(this,"handleSectionCreate",()=>{const{board:e,onSectionChange:t,sectionsResource:i,dispatch:n,onSectionCreate:o}=this.props,{searchQuery:s}=this.state;o?o(s):n&&e.id&&n(Object(r.a)({boardId:e.id,name:s})).then(e=>{i&&i.refreshData(),this.setState({searchQuery:""}),t(e)})}),p(this,"handleSectionSelected",e=>{const{onSectionChange:t}=this.props;e.id===f?(t(null),this.setState({searchQuery:""})):(t(e),this.setState({searchQuery:""}))}),p(this,"handleSearchQueryUpdate",e=>{this.setState({searchQuery:e})}),p(this,"renderRow",({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return Object(b.jsx)(j,{hovered:t,searchQuery:i,section:e})})}componentDidUpdate(e){const t=e.selectedSectionId,{selectedSectionId:i}=this.props;if(i!==t){const{sectionsResource:e}=this.props;e&&e.refreshData()}}render(){const{isStoryPin:e,sectionsResource:t,selectedSectionId:i,mergingFromSectionId:n,selectedSectionName:o}=this.props,{searchQuery:r}=this.state;let a=n?this.props.i18n._("Pick a section","default dropdown option for selecting a board section to merge to","default dropdown option for selecting a board section to merge to"):this.props.i18n._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit");if(i){let e;t&&t.data&&(e=t.data.find(e=>e.id===i)),a=e&&e.title||a}else o&&(a=o);return Object(b.jsxs)(u.f,{children:[Object(b.jsx)(u.U,{accessibilityLabel:this.props.i18n._("loading section picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!!t&&!t.isLoaded}),(!t||t&&t.isLoaded)&&Object(b.jsx)(s.a,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:a,isStoryPin:e,onCreate:n?null:this.handleSectionCreate,onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleSectionSelected,renderRow:this.renderRow,searchQuery:r,sections:this.getPickerSections()})]})}}function m(e){const t=Object(c.c)();return Object(b.jsx)(g,{...e,i18n:t})}const y=m;t.b=Object(a.compose)(Object(o.connect)(),Object(h.b)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id}),allowStale:!1}))(m)},NdQN:function(e,t,i){var n=i("q1tI"),o=i("JW66"),r=(i("9QW3"),i("n6mq")),s=i("yweb"),a=i("nKUr");function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class l extends n.Component{constructor(...e){super(...e),d(this,"setInputRef",e=>{e&&(this._input=e)}),d(this,"handleKeyDown",e=>{const{disabled:t,indexManager:i}=this.props;if(!t)switch(e.which){case o.a.KeyCode.ENTER:case o.a.KeyCode.NUMPAD_ENTER:e.preventDefault(),i.select();break;case o.a.KeyCode.UP:e.preventDefault(),i.prev();break;case o.a.KeyCode.DOWN:e.preventDefault(),i.next()}})}componentDidMount(){this._input&&this._input.focus()}render(){const{onChange:e,value:t}=this.props;return Object(a.jsx)("div",{onKeyDown:this.handleKeyDown,role:"presentation",style:{width:"100%"},children:Object(a.jsx)(r.Q,{accessibilityLabel:"",id:"pickerSearchField",onChange:({value:t})=>e(t),placeholder:this.props.i18n._("Search","search bar placeholder text","search bar placeholder text"),ref:this.setInputRef,size:"lg",value:t})})}}t.a=function(e){const t=Object(s.c)();return Object(a.jsx)(l,{...e,i18n:t})}},NjDU:function(e,t,i){function n(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}function o(e){return{type:"UPDATE_USER_FOLLOWING_COUNT",payload:e}}function r(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}function s(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return r})),i.d(t,"e",(function(){return s})),i.d(t,"g",(function(){return a})),i.d(t,"f",(function(){return d})),i.d(t,"a",(function(){return l}));const a=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),d=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function l(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}},Pqnw:function(e,t,i){function n(e,t){return{type:"FEED_INVALIDATE",payload:{feedType:e,feedId:t}}}i.d(t,"a",(function(){return n}))},Q7uW:function(e,t,i){i.d(t,"a",(function(){return r}));var n=i("n6mq"),o=i("nKUr");function r(e){const{htmlFor:t,errorMessage:i}=e;return Object(o.jsx)(n.z,{htmlFor:t,children:Object(o.jsx)(n.f,{marginTop:1,children:Object(o.jsx)(n.bb,{color:"red",size:"md",children:i})})})}},Sihc:function(e,t,i){i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return u}));var n=i("Pqnw"),o=i("uVIr"),r=i("VqlB"),s=i("eOdZ"),a=i("oN2T"),d=i("KFEb"),l=i("Wer7");function c(e,t){return{type:"SECTION_ADDED",payload:{boardId:e,section:t}}}function u({boardId:e,name:t,nameSource:i,pinImport:u,initialPinIds:h=[]}){let b=0;"RECOMMENDATION"===i?b=1:"EDITED_RECOMMENDATION"===i&&(b=2);const p={board_id:e,initial_pins:u&&!u.all?u.pinIds:h,name:t,name_source:b};return t=>s.a.create("BoardSectionResource",p).callCreate({showError:!1}).then(({resource_response:{data:i}})=>{t(c(e,i)),t(Object(o.a)({feedId:e,feedType:d.a.BOARD_SECTIONS,itemIds:[i.id],itemType:"board_section"})),t(Object(a.c)(e,"pin_count")),t(Object(l.f)("BoardSectionsRepinResource",{board_id:e}));const{all:s,pinIds:h}=u||{all:!1,pinIds:[]};return s?new Promise((n,o)=>t(Object(r.a)({inverseSelection:!0,selectedPinIds:h,source:{boardId:e,sectionId:null},target:{boardId:e,sectionId:i.id}})).then(()=>n(i)).catch(o)):(h.length>0&&t(Object(n.a)(d.a.BOARD_PINS,e)),i)})}},V711:function(e,t,i){i.d(t,"a",(function(){return x}));var n=i("q1tI"),o=i("/MKj"),r=i("8cMa"),s=i("JW66"),a=i("rrvb"),d=i("v/Q4"),l=i("0BOE"),c=i("jdx6"),u=i("Wer7"),h=i("yweb"),b=i("w70y"),p=i("n6mq"),f=i("oN2T"),j=i("nKUr");function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m({board:e,hovered:t,searchQuery:i}){const n=e.privacy===s.a.BoardPrivacy.SECRET;return Object(j.jsxs)(p.f,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:[Object(j.jsx)(p.f,{flex:"grow",children:Object(j.jsx)(p.bb,{weight:"bold",children:Object(c.b)(i,e.name)})}),Object(j.jsxs)(p.f,{direction:"row",display:"flex",flex:"none",children:[n&&Object(j.jsx)(r.a,{type:"secret"}),e.is_collaborative&&Object(j.jsx)(r.a,{type:"group"})]})]})}class y extends n.Component{constructor(e){super(e),g(this,"getSections",()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return[];const{searchQuery:t}=this.state,{boardResource:{data:{all_boards:i}}}=this.props;return t.length>=2?[{items:Object(l.a)(i,t)}]:[{items:i}]}),g(this,"createBtnDisabled",()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return!1;const{boardResource:{data:{all_boards:t}}}=this.props,{searchQuery:i}=this.state;return t.some(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase()})}),g(this,"handleBoardCreate",e=>()=>{const{searchQuery:e}=this.state;if(!e)return;const{createBoard:t,invalidateBoardPickerBoardsResource:i,onBoardCreate:n}=this.props;i(),n?n(e):t({name:e,privacy:"public"}).then(e=>{const{onBoardChosen:t}=this.props;t(e)})}),g(this,"handleBoardSelected",e=>{this.props.onBoardChosen(e),this.setState({selectedBoard:e})}),g(this,"handleSearchQueryUpdate",e=>{this.setState({searchQuery:e})}),g(this,"renderRow",({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return Object(j.jsx)(m,{board:e,hovered:t,searchQuery:i})}),this.state={searchQuery:"",selectedBoard:e.board}}render(){const{boardResource:e,board:t,isBoardlessPinsBoard:i,isStoryPin:n,viewer:o}=this.props,{searchQuery:r,selectedBoard:s}=this.state;let d=this.props.i18n._("Select a board","Label for selecting a board in Edit Pin Modal","Label for selecting a board in Edit Pin Modal");return t?d=i?this.props.i18n._("Profile","BoardPickerFlyout.displayBoarName.boardlessPins","Title indicating the pin is saved to profile"):t.name:s&&(d=s.name),Object(j.jsxs)(p.f,{children:[Object(j.jsx)(p.U,{accessibilityLabel:this.props.i18n._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!e.isLoaded}),e.data&&Object(j.jsx)(a.a,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:d,isStoryPin:n,onCreate:this.handleBoardCreate(o),onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleBoardSelected,renderRow:this.renderRow,searchQuery:r,sections:this.getSections()})]})}}function x(e){const t=Object(h.c)(),i=Object(o.useDispatch)(),n=Object(d.a)(),r=n.isAuth?n.username:"",s=Object(o.useSelector)(({advertiser:e})=>e),a=n.isAuth&&s&&s.owner_user_id!==n.id,l=a?s.id:null,c=a?s.owner_user_id:null,p=Object(b.a)({name:"BoardPickerBoardsResource",options:{pin_id:e.pinId,field_set_key:"board_picker",onlyFetchBoards:!0,username:c,...l&&c?{advertiser_id:l,filter:"protected",username:c}:{}},allowStale:!1});return Object(j.jsx)(y,{...e,advertiser_id:l,boardResource:p,createBoard:e=>i(Object(f.g)(e,void 0,r)),invalidateBoardPickerBoardsResource:()=>{i(Object(u.f)("BoardPickerBoardsResource",{field_set_key:"board_picker"}))},username:c,viewer:n,i18n:t})}},VqlB:function(e,t,i){i.d(t,"b",(function(){return f})),i.d(t,"a",(function(){return j}));var n=i("3z7j"),o=i("Pqnw"),r=i("uVIr"),s=i("MhBu"),a=i("eOdZ"),d=i("oN2T"),l=i("KFEb"),c=i("1inl"),u=i("Ye/N");function h(e){c.a.showError(function(e){switch(e.api_error_code){case 2171:case 2172:case 2173:return u.a._("Please wait until the previous board action finishes.");default:return e.message}}(e))}const b=e=>Object(o.a)(e.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,e.sectionId||e.boardId);function p(e,t){const{source:i,target:o}=e;o.boardId!==i.boardId?(t(Object(d.c)(i.boardId,"pin_count")),t(Object(d.c)(o.boardId,"pin_count"))):i.sectionId&&o.sectionId||t(Object(d.c)(o.boardId,"pin_count")),i.sectionId&&t(Object(n.a)(i.sectionId)),o.sectionId&&t(Object(n.a)(o.sectionId))}function f(e){return t=>{const{selectedPinIds:i,source:n,target:o}=e;t(Object(s.a)({feedId:n.sectionId||n.boardId,feedType:n.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:i,itemType:"pin"})),t(Object(r.a)({feedId:o.sectionId||o.boardId,feedType:o.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:i,itemType:"pin"})),p(e,t)}}function j(e){return t=>function(e,t){const{inverseSelection:i,selectedPinIds:n,source:o,target:d}=e;if(o.boardId===d.boardId&&(o.sectionId||null)===(d.sectionId||null))return Promise.reject();if(i){const e={board_id:o.boardId,new_board_id:d.boardId,old_section_id:o.sectionId||void 0,new_section_id:d.sectionId||void 0,pin_ids:n};return a.a.create("BulkEditSelectAllResource",e).callUpdate({showError:!1}).then(()=>Promise.all([t(b(o)),t(b(d))])).catch(h)}{const e=(e,i)=>{t(Object(s.a)({feedId:e.sectionId||e.boardId,feedType:e.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:n,itemType:"pin"})),t(Object(r.a)({feedId:i.sectionId||i.boardId,feedType:i.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:n,itemType:"pin"}))};e(o,d);const i=()=>e(d,o);if(d.boardId===o.boardId){if(d.sectionId){const e={section_id:d.sectionId,pins:n};return a.a.create("BoardSectionEditResource",e).callUpdate({showError:!1}).catch(e=>{i(),h(e)})}{const e={section_id:o.sectionId,pins:n};return a.a.create("BoardSectionPinsResource",e).callDelete({showError:!1}).catch(e=>{i(),h(e)})}}{const e={board_id:d.boardId,section_id:d.sectionId||void 0,pin_ids:n};return a.a.create("BulkEditResource",e).callUpdate({showError:!1}).catch(e=>{i(),h(e)})}}}(e,t).then(()=>p(e,t))}},Wrea:function(e,t,i){i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return r})),i.d(t,"d",(function(){return s})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return l}));var n=i("Wer7");const o=(e,t)=>i=>i(Object(n.a)("BoardResource",{board_id:e,field_set_key:t})),r=e=>o(e,"pin_count"),s=e=>({type:"BOARD_PIN_COUNT_CHANGED",payload:e}),a=e=>({type:"BOARD_INVITE_ACCEPTED_BY_VIEWER",payload:{boardId:e}}),d=(e,t)=>({type:"BOARD_COVER_IMAGE_UPDATED",payload:{boardId:e,coverPin:t}}),l=e=>({type:"BOARD_DISABLE_MORE_IDEAS_BADGING",payload:{boardId:e}})},eIuQ:function(e,t,i){i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return r})),i.d(t,"d",(function(){return s})),i.d(t,"c",(function(){return a}));var n=i("Ye/N");function o(e){return e?n.a._("Title too long. Make sure all cards' titles have less than 100 characters","Title entered is too long while editing a carousel pin and/or one of its pins","Title entered is too long while editing a carousel pin and/or one of its pins"):n.a._("Title too long. Make sure title has less than 100 characters","Title entered is too long while editing a pin","Title entered is too long while editing a pin")}function r(e){return e?n.a._("Description too long. Make sure all cards' descriptions have less than 500 characters","Description entered is too long while editing a carousel pin and/or one of its pins","Description entered is too long while editing a carousel pin and/or one of its pins"):n.a._("Description too long. Make sure description has less than 500 characters","Description entered is too long while editing a pin","Description entered is too long while editing a pin")}function s(e){return n.a._("Too many mentions. Make sure you have at most 5.","editPinModal.errorMessages.userMentionOverLimit","Too many mentions used in the description")}function a(e){return e?n.a._("Need to provide a valid URL. Make sure all cards' links are valid","Invalid URL/link provided while editing a carousel pin and/or one of its pins","Invalid URL/link provided while editing a carousel pin and/or one of its pins"):n.a._("Need to provide a valid URL. Make sure the link is valid","Invalid URL/link provided while editing a pin","Invalid URL/link provided while editing a pin")}},gdcG:function(e,t,i){i.d(t,"a",(function(){return r}));var n=i("2WXK"),o=i("nKUr");function r(e){return function(t){const{isHovering:i,hoverHandlers:r}=Object(n.a)();return Object(o.jsx)(e,{...t,hoverHandlers:r,isHovering:i})}}},jdx6:function(e,t,i){i.d(t,"b",(function(){return d}));var n=i("8cMa"),o=i("JW66"),r=i("yweb"),s=i("n6mq"),a=i("nKUr");function d(e,t=""){const i=e&&e.length>1?new RegExp(e,"i"):"";return e&&e.length>1?t.split(i).reduce((i,n,o)=>{if(i.length>0&&e&&e.length){const r=t.toLowerCase().indexOf(e.toLowerCase());return i.concat(Object(a.jsx)("em",{style:{borderBottom:"1px solid #333",fontStyle:"normal",paddingBottom:"1px"},children:t.substring(r,r+e.length)},o),n)}return[n]},[]):t}t.a=function(e){const t=Object(r.c)(),{disabled:i,item:l,isSection:c,isSelectMode:u,isWithinSectionPicker:h,saveState:b,searchQuery:p,selected:f}=e,j=c?null:l,g=c?l:null,m=g&&g.title||j&&j.name||"";let y="",x=!1,_="",O=0;j&&({image_cover_url:y,is_collaborative:x,privacy:_,section_count:O=0}=j);const v=d(p,m),S=_===o.a.BoardPrivacy.SECRET,C=!i&&(f||!!b),w=!h&&"number"==typeof O&&O>0,I="number"==typeof O&&O>0?"boardWithSection":"boardWithoutSection",E=u?t._("Select","Board select button label","Board select button label"):t._("Save","Pin save button label","Pin save button label");return Object(a.jsxs)(s.f,{alignItems:"center",color:C?"lightGray":"white",display:"flex",paddingX:6,paddingY:2,"data-test-id":I,children:[j?Object(a.jsx)(s.f,{height:36,width:36,color:"lightGray",overflow:"hidden",rounding:2,marginEnd:2,flex:"none",children:y?Object(a.jsx)(s.y,{src:y,alt:m,fit:"cover",naturalWidth:1,naturalHeight:1}):Object(a.jsx)("span",{})}):Object(a.jsx)(s.f,{height:36,paddingX:2}),Object(a.jsxs)(s.f,{alignItems:"center",justifyContent:"between",display:"flex",flex:"grow",children:[Object(a.jsx)(s.bb,{color:i?"gray":"darkGray",size:"md",truncate:!0,weight:"bold",children:v}),(w||!C)&&Object(a.jsxs)(s.f,{alignItems:"center",display:"flex",children:[S&&Object(a.jsx)(n.a,{type:"secret"}),x&&Object(a.jsx)(n.a,{type:"group"}),w&&Object(a.jsx)(n.a,{type:"sections"})]}),!w&&C&&!b&&Object(a.jsxs)(s.f,{alignItems:"center",color:"red","data-test-id":"BoardPickerSaveButton",display:"flex",flex:"none",paddingX:3,paddingY:2,rounding:4,children:[!u&&Object(a.jsx)(s.f,{dangerouslySetInlineStyle:{__style:{marginRight:3,marginLeft:-6}},children:Object(a.jsx)(s.w,{accessibilityLabel:"",color:"white",icon:"pin",inline:!0,size:20})}),Object(a.jsx)(s.bb,{color:"white",overflow:"normal",size:"md",weight:"bold",children:E})]}),!w&&C&&"loading"===b&&Object(a.jsx)(s.f,{dangerouslySetInlineStyle:{__style:{transform:"scale(0.7)"}},maxHeight:35,children:Object(a.jsx)(s.U,{accessibilityLabel:t._("Saving","Accessibility label for saving a pin to a board","Accessibility label for saving a pin to a board"),show:!0})})]})]})}},"kT2/":function(e,t,i){var n=i("q1tI"),o=i("JW66"),r=i("yweb"),s=i("n6mq"),a=i("nKUr");const d=e=>{const t=e.split("\n");t.push("");const i=[];let n,o=[];return t.forEach(e=>{const t=e.indexOf("•");t>-1?(n||(n=""),o.push(e.substring(t+1).trim())):((n||o.length>0)&&i.push({heading:n,items:o}),n=e,o=[])}),i},l=e=>{let t="";return e.forEach((i,n)=>{const{heading:o,items:r}=i;o&&(t+=o),r&&r.length>0&&(t+="\n• "+r.join("\n• ")),n<e.length-1&&(t+="\n\n")}),t};t.a=function({header:e,helperText:t,listBlocks:i,onUpdate:c,placeholderListBlocks:u}){const h=Object(r.c)(),b=l(u||[{heading:h._("What you'll need","storyboard.detailsList.placeholder","Placeholder text header for details list of story Pin"),items:[h._("Write a bullet list of tools, materials and anything else!","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin"),h._("Type it up or copy and paste.","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin")]}]),[p,f]=Object(n.useState)(i?l(i):"");return Object(a.jsx)(s.f,{children:Object(a.jsx)(s.cb,{id:"storyboard-details-list",helperText:t,label:e,onChange:({value:e})=>{f(e),c(d(e))},onBlur:()=>{""===p.trim()&&f("")},onKeyDown:({event:e,value:t})=>{const{keyCode:i,target:n,shiftKey:r}=e;if(n instanceof HTMLTextAreaElement){const{selectionStart:s,selectionEnd:a}=n;if(s===a){let a=0,l=0,u="";if(i===o.a.KeyCode.ENTER?"\n• "!==t.substring(s-3,s)||"\n"!==t.substring(s,s+1)&&s!==t.length?r||"\n"===t.substring(s-1,s)||(a=0,u="\n• "):(a=-3,u="\n"):i!==o.a.KeyCode.BACKSPACE&&i!==o.a.KeyCode.DELETE||("\n• "===t.substring(s-3,s)?a=-3:"\n•"===t.substring(s-2,s)?a=-2:"\n"===t.substring(s-1,s)&&"•"===t.substring(s,s+1)&&(a=-1,l=1)),0!==a||0!==l||""!==u){const i=t.substring(0,s+a)+u+t.substring(s+l);f(i);const o=s+a+u.length;setTimeout(()=>{n.selectionStart=o,n.selectionEnd=o},10),c(d(i)),e.preventDefault()}}}},placeholder:b,rows:7,value:p})})}},mEMi:function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("q1tI"),o=i("DzJC"),r=i.n(o);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends n.PureComponent{constructor(...e){super(...e),s(this,"setContainerRef",e=>{this.containerRef=e}),s(this,"fetchMoreIfNecessary",r()(()=>{const{fetchMore:e,scrollBuffer:t}=this.props;e&&this.containerRef&&(({scrollTop:e,clientHeight:t,scrollHeight:i},n)=>e+t+(n?n(t):2*t)>i)(this.containerRef,t)&&e()},200))}componentDidMount(){setTimeout(this.fetchMoreIfNecessary)}componentDidUpdate(){this.fetchMoreIfNecessary()}render(){const{children:e}=this.props;return e({onScroll:this.fetchMoreIfNecessary,setRef:this.setContainerRef})}}},oN2T:function(e,t,i){i.d(t,"c",(function(){return f})),i.d(t,"b",(function(){return j})),i.d(t,"j",(function(){return g})),i.d(t,"g",(function(){return m})),i.d(t,"e",(function(){return y})),i.d(t,"n",(function(){return x})),i.d(t,"h",(function(){return O})),i.d(t,"d",(function(){return v})),i.d(t,"a",(function(){return S})),i.d(t,"m",(function(){return C})),i.d(t,"k",(function(){return w})),i.d(t,"l",(function(){return I})),i.d(t,"f",(function(){return E})),i.d(t,"i",(function(){return k}));var n=i("4dcN"),o=i("Pqnw"),r=i("7w6Q"),s=i("eOdZ"),a=i("nrog"),d=i("KFEb"),l=i("5FNA"),c=i("NjDU"),u=i("Wer7");const h="board_create",b="board_delete",p="board_edit";function f(e,t){return Object(u.a)("BoardResource",{board_id:e,field_set_key:t})}function j(e={},t,i){return{type:"BOARD_CREATE_COMPLETE",payload:{options:e,board:t},error:i}}function g(e){return t=>{e&&Object(l.b)(e).forEach(e=>{t(e)})}}function m(e,t,i){const o={...e};return r=>(r({type:"BOARD_CREATE",payload:{board:e}}),s.a.create("BoardResource",o).callCreate().then(e=>{n.a.trackEvent(h,"success");const s=e.resource_response.data;return s&&(r(g(i)),null!=t&&t.isFBC||r(j(o,s)),r(Object(a.a)(s.owner.id))),s}).catch(e=>{throw n.a.trackEvent(h,"error"),e}))}function y(e={},t,i){return{type:"BOARD_UPDATE_COMPLETE",payload:{options:e,board:t},error:i}}function x(e){return t=>{const i=void 0===e.collaborator_requests_enabled||null===e.collaborator_requests_enabled?{}:{collaborator_requests_enabled:e.collaborator_requests_enabled},o={board_id:e.id,name:e.name,description:e.description,category:e.category,collaborator_permissions_setting:e.collaborator_permissions_setting,privacy:e.privacy,collab_board_email:e.collab_board_email,collaborator_invites_enabled:e.collaborator_invites_enabled,allow_homefeed_recommendations:e.allow_homefeed_recommendations,...i};return t({type:"BOARD_UPDATE",payload:{boardUpdateOptions:o}}),s.a.create("BoardResource",o).callUpdate().then(i=>{n.a.trackEvent(p,"success");const r=i&&i.resource_response&&i.resource_response.data||e;t(y(o,r))}).catch(e=>{throw n.a.trackEvent(p,"error"),e})}}function _(e,t){return{type:"BOARD_DELETE_COMPLETE",payload:{boardId:e},error:t}}function O(e){return(t,i)=>{var o;const r=i().boards.content[e],{pin_count:a}=r,{id:d=""}=null!==(o=r.owner)&&void 0!==o?o:{};return t({type:"BOARD_DELETE",payload:{boardId:e}}),s.a.create("BoardResource",{board_id:e}).callDelete().then(()=>{n.a.trackEvent(b,"error"),t(_(e)),t(Object(c.c)({userId:d,increment:"number"==typeof a?-a:0}))}).catch(e=>{throw n.a.trackEvent(b,"error"),e})}}function v(e){return{type:"BOARD_PIN_TO",payload:{board:e}}}function S(e){return t=>(t(function(e){return{type:"BOARD_ARCHIVED",payload:{boardId:e}}}(e)),s.a.create("BoardArchiveResource",{boardId:e}).callUpdate())}function C(e){return t=>(t(function(e){return{type:"BOARD_UNARCHIVED",payload:{boardId:e}}}(e)),s.a.create("BoardArchiveResource",{boardId:e}).callDelete())}function w(e,t){return i=>s.a.create("BoardsMergeResource",{source_board_id:e,target_board_id:t}).callUpdate().then(()=>Promise.all([i(_(e)),i(f(t,"pin_count")),i(Object(o.a)(d.a.BOARD_SECTIONS,t))]))}function I(e,t){return i=>s.a.create("SocialSearchCampaignResource",{boardId:e}).callGet().then(e=>{if(!e||!e.resource_response){return i({type:"SET_SOCIAL_SEASONAL_BOARD",payload:{isSocialSeasonalBoard:!1,socialHeaderBgImage:"",socialHeaderBgColor:"",textIconColor:""}})}const n=e.resource_response.data||{},o=(n.model||{}).custom_properties||{},{campaign_id:s="unknown"}=o,a=n.display_data||{},d={isSocialSeasonalBoard:!!n.display_data,socialHeaderBgImage:a.header_image,socialHeaderBgColor:a.header_background_color,textIconColor:a.text_icon_color};return r.a.increment(`web.seasonal_board.${s}.${t}.land`),i({type:"SET_SOCIAL_SEASONAL_BOARD",payload:d})})}function E(){return e=>e({type:"SET_SOCIAL_SEASONAL_BOARD",payload:{isSocialSeasonalBoard:!1,socialHeaderBgImage:"",socialHeaderBgColor:"",textIconColor:""}})}function k(e){return{type:"BOARD_DISMISS_SENSITIVITY_SCREEN",payload:{boardId:e}}}},qVfT:function(e,t,i){i.d(t,"a",(function(){return o}));var n=i("eOdZ");function o(e,t,i){return async o=>{const r=n.a.create("ApiResource",{url:`/v3/pins/${e}/notes/`,data:{pin_note_content:i}});let s;s=i?t?await r.callUpdate():await r.callCreate():await r.callDelete();const{resource_response:a}=s;o(function(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}(e,null==a?void 0:a.data))}}},rrvb:function(e,t,i){var n=i("q1tI"),o=i("9QW3"),r=i("NdQN"),s=i("IBrh"),a=i("yweb"),d=i("gdcG"),l=i("n6mq"),c=i("nKUr");function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends n.Component{constructor(...e){super(...e),u(this,"state",{showFlyout:!1}),u(this,"setContainerRef",e=>{this.containerRef=e}),u(this,"handleCreate",()=>{this.hideFlyout();const{onCreate:e}=this.props;e&&e()}),u(this,"handleSelectItem",e=>{this.hideFlyout();const{onSelect:t,onCreate:i}=this.props;e?t(e):i&&i()}),u(this,"handleDropdownTouch",()=>{this.setState(e=>({showFlyout:!e.showFlyout}))}),u(this,"handleHideFlyout",e=>{this.containerRef&&e.target instanceof HTMLElement&&!this.containerRef.contains(e.target)&&this.hideFlyout()}),u(this,"hideFlyout",()=>{const{hoverHandlers:{onMouseLeave:e}}=this.props;e(),this.setState({showFlyout:!1})})}componentDidMount(){document.addEventListener("click",this.handleHideFlyout,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleHideFlyout,{capture:!0})}render(){const{dropdownValue:e,fetchMore:t,hoverHandlers:{onMouseOver:i,onMouseLeave:n},isHovering:a,isStoryPin:d,onCreate:u,onSearchQueryUpdate:h,renderRow:b,searchQuery:p,sections:f,createBtnDisabled:j}=this.props,{showFlyout:g}=this.state;this.indexManager=new o.a(f.map(e=>e.items)),this.indexManager.setSelectItem(this.handleSelectItem);const m=!p.trim()||!!j;return Object(c.jsxs)("div",{ref:this.setContainerRef,style:{...d?{flex:"grow"}:{}},children:[Object(c.jsx)(l.ab,{fullWidth:!!d,onMouseEnter:i,onMouseLeave:n,onTap:this.handleDropdownTouch,rounding:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:a?"lightWash":"lightGray",direction:"row",display:"flex",flex:"grow",paddingX:4,paddingY:d?4:3,rounding:d?4:2,children:[Object(c.jsx)(l.f,{display:"flex",flex:"grow",children:Object(c.jsx)(l.bb,{weight:"bold",children:e})}),Object(c.jsx)(l.w,{accessibilityLabel:"",color:"darkGray",icon:"arrow-down",size:14})]})}),g&&Object(c.jsx)(l.f,{position:"relative",children:Object(c.jsxs)(l.f,{borderStyle:"sm",color:"white",dangerouslySetInlineStyle:{__style:{zIndex:1}},direction:"column",display:"flex",overflow:"hidden",position:"absolute",rounding:d?4:2,width:"100%",children:[Object(c.jsx)(l.f,{children:Object(c.jsxs)(l.f,{display:"flex",marginStart:-1,marginEnd:-1,padding:2,children:[Object(c.jsx)(l.f,{display:"flex",flex:"grow",paddingX:1,children:Object(c.jsx)(r.a,{hideIcon:!0,indexManager:this.indexManager,onChange:h,value:p})}),u&&Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{disabled:m,onClick:this.handleCreate,text:this.props.i18n._("Create","board or section dropdown create button","board or section dropdown create button")})})]})}),Object(c.jsx)(s.a,{fetchMore:t,indexManager:this.indexManager,maxHeight:240,onSelectItem:this.handleSelectItem,renderItem:b,sections:f})]})})]})}}t.a=Object(d.a)((function(e){const t=Object(a.c)();return Object(c.jsx)(h,{...e,i18n:t})}))},uVIr:function(e,t,i){function n(e){return{type:"FEED_ITEMS_ADDED",payload:e}}i.d(t,"a",(function(){return n}))},xOLo:function(e,t,i){i.r(t),i.d(t,"CarouselSliders",(function(){return p}));var n=i("/MKj"),o=i("XSD5"),r=i("6/Sz"),s=i("yweb"),a=i("0nTG"),d=i("U4JR"),l=i("n6mq"),c=i("nKUr");const u={slider:{cursor:"pointer",height:"100%",position:"relative",width:"10%",zIndex:"105",pointerEvents:"auto"}},h=(e,t,i,n,o,r,s,l,c,u)=>{if(!u||!o){const{carousel_slots:u,id:h}=o;Object(d.b)(108,{...c,objectId:t,component:l,view:s,viewParameter:r,eventData:{pinCarouselSlotEventData:{carouselSlotId:(null==u?void 0:u[i])&&Number(u[i].id),carouselDataId:Number(h),carouselSlotIndex:i,toCarouselSlotIndex:n}},...Object(a.f)(e)||{}})}},b=(e,t,i,n,o,r)=>{r||void 0===n||(e.preventDefault(),e.stopPropagation(),n(t,i)),void 0!==o&&o(i)},p=({carouselIndex:e,carouselData:t,changeCarouselSlotIndex:i,handleCarouselSwipe:n,pin:o,pinId:r,contextLogData:a,viewParameter:d,viewType:p,componentType:f,isEditMode:j})=>{const g=Object(s.c)();if(!t)return null;const{carousel_slots:m=[],index:y=0}=t,x=void 0!==e?e:y,_=Math.max(0,x-1),O=Math.min(m.length-1,x+1);return Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",position:"absolute",left:!0,right:!0,bottom:!0,top:!0,children:[Object(c.jsx)("div",{"data-test-id":"carousel-slider-left",role:"presentation",onClick:e=>{b(e,r,_,i,n,j),h(o,r,x,_,t,d,p,f,a,j)},onKeyUp:e=>{b(e,r,_,i,n,j),h(o,r,x,_,t,d,p,f,a,j)},style:u.slider,children:x>0&&Object(c.jsx)(l.f,{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.w,{color:"white",icon:"arrow-back",accessibilityLabel:g._("View Previous","Button to advance carousel to the previous image","Button to advance carousel to the previous image")})})}),Object(c.jsx)("div",{"data-test-id":"carousel-slider-right",role:"presentation",onClick:e=>{b(e,r,O,i,n,j),h(o,r,x,O,t,d,p,f,a,j)},onKeyUp:e=>{b(e,r,O,i,n,j),h(o,r,x,O,t,d,p,f,a,j)},style:u.slider,children:x<m.length-1&&Object(c.jsx)(l.f,{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.w,{color:"white",icon:"arrow-forward",accessibilityLabel:g._("View Next","Button to advance carousel to the next image","Button to advance carousel to the next image")})})})]})};t.default=Object(n.connect)(({pins:e},{carouselData:t,pinId:i})=>{const n=e[i];return{pin:n,carouselData:t||Object(r.a)(n)}},e=>({changeCarouselSlotIndex:(t,i)=>e(Object(o.a)(t,i))}))(p)}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/123-4b461272eafafdd8d9a5.mjs.map